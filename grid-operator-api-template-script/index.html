



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the Grid Singularity Exchange">
      
      
        <link rel="canonical" href="https://gridsingularity.github.io/gsy-e/documentation/grid-operator-api-template-script/">
      
      
        <meta name="author" content="Grid Singularity">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/Profile.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>Grid Operator API Template Script - Grid Singularity Wiki</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"PT Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#time-of-use-tou" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://gridsingularity.github.io/gsy-e/documentation/" title="Grid Singularity Wiki" class="md-header-nav__button md-logo">
          
            <img src="../img/Profile.png" width="32" height="32">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Grid Singularity Wiki
            </span>
            <span class="md-header-nav__topic">
              Grid Operator API Template Script
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/gridsingularity/gsy-e/wiki/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Grid Singularity Exchange
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://gridsingularity.github.io/gsy-e/documentation/" title="Grid Singularity Wiki" class="md-nav__button md-logo">
      
        <img src="../img/Profile.png" width="48" height="48">
      
    </a>
    Grid Singularity Wiki
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/gridsingularity/gsy-e/wiki/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Grid Singularity Exchange
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      General Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        General Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../documentation/" title="Grid Singularity Mission" class="md-nav__link">
      Grid Singularity Mission
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../technical-approach/" title="Grid Singularity Technical Approach" class="md-nav__link">
      Grid Singularity Technical Approach
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../development-path/" title="Grid Singularity Development Path" class="md-nav__link">
      Grid Singularity Development Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../licensing/" title="Licensing and Open Source Ethos" class="md-nav__link">
      Licensing and Open Source Ethos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Set up a simulation of an active local energy market
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Set up a simulation of an active local energy market
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      Introduction to the Grid Singularity Exchange Interface: Singularity Map
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Introduction to the Grid Singularity Exchange Interface: Singularity Map
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../community/" title="Build a community" class="md-nav__link">
      Build a community
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1-2" type="checkbox" id="nav-2-1-2">
    
    <label class="md-nav__link" for="nav-2-1-2">
      Assets configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-2">
        Assets configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../configuration/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../home/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../solar-panels/" title="Solar Panels (PVs)" class="md-nav__link">
      Solar Panels (PVs)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../consumption/" title="Consumption (Load Profiles)" class="md-nav__link">
      Consumption (Load Profiles)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../battery/" title="Battery (Storage)" class="md-nav__link">
      Battery (Storage)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../power-plant/" title="Power Plant" class="md-nav__link">
      Power Plant
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../community-settings/" title="Community Settings" class="md-nav__link">
      Community Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-market-settings/" title="Grid Market Settings" class="md-nav__link">
      Grid Market Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../events/" title="Events (Adding Assets, Communities, etc.)" class="md-nav__link">
      Events (Adding Assets, Communities, etc.)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1-6" type="checkbox" id="nav-2-1-6">
    
    <label class="md-nav__link" for="nav-2-1-6">
      Results and Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-6">
        Results and Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../results-dashboard" title="Results dashboard" class="md-nav__link">
      Results dashboard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../results-community" title="Community" class="md-nav__link">
      Community
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bills-traded-energy/" title="Bills and traded energy" class="md-nav__link">
      Bills and traded energy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../self-sufficiency-self-consumption/" title="Self-Sufficiency and Self-Consumption" class="md-nav__link">
      Self-Sufficiency and Self-Consumption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../trade-profile/" title="Trade profile" class="md-nav__link">
      Trade profile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../summary/" title="Summary" class="md-nav__link">
      Summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../price/" title="Price" class="md-nav__link">
      Price
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../trades/" title="Trades" class="md-nav__link">
      Trades
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../results-download/" title="Results Download" class="md-nav__link">
      Results Download
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Instructions for researchers on backend code
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Instructions for researchers on backend code
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2-1" type="checkbox" id="nav-2-2-1">
    
    <label class="md-nav__link" for="nav-2-2-1">
      Backend Installation Instructions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-1">
        Backend Installation Instructions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../linux-installation-instructions/" title="Linux Installation Instructions" class="md-nav__link">
      Linux Installation Instructions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ios-installation-instructions/" title="Mac Installation Instructions" class="md-nav__link">
      Mac Installation Instructions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vm-installation-instructions/" title="Virtual Machine Installation Instructions" class="md-nav__link">
      Virtual Machine Installation Instructions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version-update/" title="Version Updates" class="md-nav__link">
      Version Updates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2-2" type="checkbox" id="nav-2-2-2">
    
    <label class="md-nav__link" for="nav-2-2-2">
      Backend Simulation Configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-2">
        Backend Simulation Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../setup-configuration/" title="Setup Configuration" class="md-nav__link">
      Setup Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../setting-configuration-parameters/" title="Setting General Configuration Parameters" class="md-nav__link">
      Setting General Configuration Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../market-backend-configuration/" title="Market Backend Configuration" class="md-nav__link">
      Market Backend Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../assets-installation/" title="Assets Installation" class="md-nav__link">
      Assets Installation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2-3" type="checkbox" id="nav-2-2-3">
    
    <label class="md-nav__link" for="nav-2-2-3">
      Backend Results
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-3">
        Backend Results
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../backend-results-overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../backend-results-energy-bills/" title="Energy bills" class="md-nav__link">
      Energy bills
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requirements/" title="Data Requirements and File Upload Format" class="md-nav__link">
      Data Requirements and File Upload Format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Market Mechanisms
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Market Mechanisms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Market Types
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Market Types
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../market-types/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-2" type="checkbox" id="nav-3-1-2">
    
    <label class="md-nav__link" for="nav-3-1-2">
      Spot Market
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-2">
        Spot Market
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../spot-market-types/" title="Spot Maket Types" class="md-nav__link">
      Spot Maket Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../one-sided-pay-as-offer/" title="One-Sided Pay-as-Offer Market" class="md-nav__link">
      One-Sided Pay-as-Offer Market
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../two-sided-pay-as-bid/" title="Two-Sided Pay-as-Bid Market" class="md-nav__link">
      Two-Sided Pay-as-Bid Market
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../two-sided-pay-as-clear/" title="Two-Sided Pay-as-Clear Market" class="md-nav__link">
      Two-Sided Pay-as-Clear Market
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-3" type="checkbox" id="nav-3-1-3">
    
    <label class="md-nav__link" for="nav-3-1-3">
      Balancing Market
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-3">
        Balancing Market
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../balancing-market/" title="Balancing Market Structure" class="md-nav__link">
      Balancing Market Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../balancing-implementation/" title="Balancing Market Implementation" class="md-nav__link">
      Balancing Market Implementation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-4" type="checkbox" id="nav-3-1-4">
    
    <label class="md-nav__link" for="nav-3-1-4">
      Settlement Market
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-4">
        Settlement Market
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../settlement-market-structure/" title="Settlement Market Structure" class="md-nav__link">
      Settlement Market Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-4-2" type="checkbox" id="nav-3-1-4-2">
    
    <label class="md-nav__link" for="nav-3-1-4-2">
      Settlement Market Implementation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-1-4-2">
        Settlement Market Implementation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../markets-rotation/" title="Markets and rotation" class="md-nav__link">
      Markets and rotation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../assets-strategies/" title="Assets strategies" class="md-nav__link">
      Assets strategies
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../market-agent/" title="Bids/Offers Process and Hierarchical Market Structure" class="md-nav__link">
      Bids/Offers Process and Hierarchical Market Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../default-trading-strategy/" title="Trading Strategies" class="md-nav__link">
      Trading Strategies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Grid Fee Accounting
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Grid Fee Accounting
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-fees/" title="Grid Fee Objectives" class="md-nav__link">
      Grid Fee Objectives
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../constant-fees/" title="Constant Grid Fee Calculation" class="md-nav__link">
      Constant Grid Fee Calculation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../percentage-fees/" title="Percentage Grid Fee Calculation" class="md-nav__link">
      Percentage Grid Fee Calculation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../degrees-of-freedom/" title="Degrees of Freedom" class="md-nav__link">
      Degrees of Freedom
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Collaborations and APIs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Collaborations and APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../collaboration/" title="Create a Grid Singularity Collaboration" class="md-nav__link">
      Create a Grid Singularity Collaboration
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked>
    
    <label class="md-nav__link" for="nav-4-2">
      Connect to the Grid Singularity APIs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Connect to the Grid Singularity APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../APIs-introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-2" type="checkbox" id="nav-4-2-2">
    
    <label class="md-nav__link" for="nav-4-2-2">
      Configure trading strategies through the Grid Singularity Asset API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-2">
        Configure trading strategies through the Grid Singularity Asset API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../configure-trading-strategies-walkthrough/" title="Walkthrough" class="md-nav__link">
      Walkthrough
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-2-2" type="checkbox" id="nav-4-2-2-2">
    
    <label class="md-nav__link" for="nav-4-2-2-2">
      Asset API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-2-2-2">
        Asset API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../asset-api-events/" title="Asset API Events" class="md-nav__link">
      Asset API Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../asset-api-commands/" title="Asset API Commands" class="md-nav__link">
      Asset API Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../asset-api-template-script/" title="Asset API Template Script" class="md-nav__link">
      Asset API Template Script
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-2-3" type="checkbox" id="nav-4-2-2-3">
    
    <label class="md-nav__link" for="nav-4-2-2-3">
      Launch the Asset API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-2-2-3">
        Launch the Asset API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-asset-api-user-interface/" title="Registration - Simulations run on the User-Interface" class="md-nav__link">
      Registration - Simulations run on the User-Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-asset-api-backend/" title="Registration - Simulations run on the Backend" class="md-nav__link">
      Registration - Simulations run on the Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-3" type="checkbox" id="nav-4-2-3" checked>
    
    <label class="md-nav__link" for="nav-4-2-3">
      Implement dynamic grid fees through the Grid Singlarity Grid Operator API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-3">
        Implement dynamic grid fees through the Grid Singlarity Grid Operator API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../implement-grid-fees-walkthrough/" title="Walkthrough" class="md-nav__link">
      Walkthrough
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-3-2" type="checkbox" id="nav-4-2-3-2" checked>
    
    <label class="md-nav__link" for="nav-4-2-3-2">
      Grid Operator API.
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-2-3-2">
        Grid Operator API.
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-operator-api-events/" title="Grid Operator API Events" class="md-nav__link">
      Grid Operator API Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-operator-api-commands/" title="Grid Operator API Commands" class="md-nav__link">
      Grid Operator API Commands
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Grid Operator API Template Script
      </label>
    
    <a href="./" title="Grid Operator API Template Script" class="md-nav__link md-nav__link--active">
      Grid Operator API Template Script
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#time-of-use-tou" title="Time-of-Use (ToU)" class="md-nav__link">
    Time-of-Use (ToU)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aziiz-pricing" title="Aziiz pricing" class="md-nav__link">
    Aziiz pricing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#script-configuration" title="Script Configuration" class="md-nav__link">
    Script Configuration
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-3-3" type="checkbox" id="nav-4-2-3-3">
    
    <label class="md-nav__link" for="nav-4-2-3-3">
      Launch the Grid Operator API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-2-3-3">
        Launch the Grid Operator API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-grid-operator-api-user-interface/" title="Registration - Simulations run on the User-Interface" class="md-nav__link">
      Registration - Simulations run on the User-Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-grid-operator-api-backend/" title="Registration - Simulations run on the Backend" class="md-nav__link">
      Registration - Simulations run on the Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Grid Singularity Canary Test Network
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Grid Singularity Canary Test Network
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-ctn/" title="Connect to a Grid Singularity Canary Test Network" class="md-nav__link">
      Connect to a Grid Singularity Canary Test Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Send live energy asset data streams to the Grid Singularity exchange
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Send live energy asset data streams to the Grid Singularity exchange
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../connection-energy-assets/" title="Establish a connection with your energy assets" class="md-nav__link">
      Establish a connection with your energy assets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../send-data-exchange-sdk/" title="Send live data streams via the Exchange SDK" class="md-nav__link">
      Send live data streams via the Exchange SDK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../send-data-rest-api/" title="Send live data streams via the REST API" class="md-nav__link">
      Send live data streams via the REST API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../blockchain/" title="Blockchain Integration" class="md-nav__link">
      Blockchain Integration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../references/" title="References" class="md-nav__link">
      References
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../releases/" title="Releases Archive" class="md-nav__link">
      Releases Archive
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#time-of-use-tou" title="Time-of-Use (ToU)" class="md-nav__link">
    Time-of-Use (ToU)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aziiz-pricing" title="Aziiz pricing" class="md-nav__link">
    Aziiz pricing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#script-configuration" title="Script Configuration" class="md-nav__link">
    Script Configuration
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/gridsingularity/gsy-e/wiki/edit/master/docs/grid-operator-api-template-script.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Grid Operator API Template Script</h1>
                
                <p>A Grid Operator API template script is available <a href="https://github.com/gridsingularity/gsy-e-sdk/blob/master/gsy_e_sdk/setups/grid_operator_api_template.py">here</a>. This is a flexible and versatile Python script for easy modification and implementation of custom grid fee strategies. See the <code>TODO</code> flags there to see how to configure your grid fee strategy and extract market data.</p>
<p>In this script two template strategies are available:</p>
<h3 id="time-of-use-tou">Time-of-Use (ToU)<a class="headerlink" href="#time-of-use-tou" title="Permanent link">&para;</a></h3>
<p>This is a strategy where grid fee is applied depending on the <strong>time of the day</strong> (hours and minutes) regardless of the market conditions. After analysing import and export patterns of their client, grid operators can create a time-based curve, increasing fees at peak predicted times (e.g. morning and dinner time).</p>
<p>Here is an example of ToU strategy that was used by the DSOs in one of the experiments at <a href="https://gridsingularity.medium.com/energy-singularity-challenge-2020-testing-novel-grid-fee-models-and-intelligent-peer-to-peer-6a0d715a9063">Odyssey hackathon</a>.</p>
<p><img alt="alt_text" src="../img/grid-operator-api-2.png" /></p>
<h3 id="aziiz-pricing">Aziiz pricing<a class="headerlink" href="#aziiz-pricing" title="Permanent link">&para;</a></h3>
<p>The Aziiz model is using past market information to determine the next grid fee. The model looks at <strong>past imports and exports</strong> on a specific market, applies a moving average and then based on this number sets the next grid fee for that market. This model has the advantage of integrating market conditions into its strategy. For instance if past market slots experienced high imports, the model will increase fees in the relevant market to incentivise market participants to contain the energy within that area.</p>
<h3 id="script-configuration">Script Configuration<a class="headerlink" href="#script-configuration" title="Permanent link">&para;</a></h3>
<p>At the start of the SDK Script, the user needs to specify the markets she/he wishes to connect and manage as well as the <a href="../asset-api-events/">Oracle name</a>.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># CONFIGURATIONS</span>
<span class="c1">################################################</span>
<span class="n">automatic</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># List of market the Grid Operators connect to</span>
<span class="n">market_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Grid&quot;</span><span class="p">,</span> <span class="s2">&quot;Community&quot;</span><span class="p">]</span>  <span class="c1"># TODO list the market names as they are in the collaboration</span>

<span class="c1"># Name of your aggregator</span>
<span class="n">oracle_name</span> <span class="o">=</span> <span class="s2">&quot;dso</span>
</code></pre></div>

<p>Right after that, the user can select the strategy to use (Time of Use or Aziiz model). To select the Time of Use strategy, you have to set TimeOfUse to True and Aziiz to False. On the other hand, to select the Aziiz model, the user has to set TimeOfUse to False and Aziiz to True.
If the Aziiz model is selected, the user can tune parameters such as applying the moving average and specifying the number of past market slots to average.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Grid tariff selection</span>
<span class="n">TimeOfUse</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># TODO Activate the Time of Use model if set to True</span>
<span class="n">Aziiz</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># TODO Activate the Aziiz model if set to True</span>
<span class="n">moving_average_peak</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Perform a moving average of the last #look_back ptu (for the Aziiz tariff only)</span>
<span class="n">look_back</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Number of past markets slots to apply the moving average (for the Aziiz tariff only)</span>

<span class="n">slot_length</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># leave as is</span>


<span class="k">def</span> <span class="nf">fee_strategy</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">TimeOfUse</span><span class="p">:</span>
        <span class="n">market_prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span><span class="s2">&quot;resources/ToU.xlsx&quot;</span><span class="p">))</span>  <span class="c1"># TODO upload an Excel/CSV file with prices of every market at each time slot (based on given template)</span>

        <span class="n">planned_fee</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">market_prices</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">market_names</span><span class="p">:</span>
                <span class="n">planned_fee</span><span class="o">.</span><span class="n">update</span><span class="p">({(</span><span class="nb">str</span><span class="p">(</span><span class="n">market_prices</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">j</span><span class="p">):</span> <span class="n">market_prices</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]})</span>

    <span class="k">if</span> <span class="n">Aziiz</span><span class="p">:</span>
        <span class="n">market_prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span> <span class="s2">&quot;resources/Aziiz.xlsx&quot;</span><span class="p">))</span>  <span class="c1"># TODO upload an Excel/CSV file with thresholds and fees of every market (based on given template)</span>

    <span class="k">return</span> <span class="n">market_prices</span><span class="p">,</span> <span class="n">planned_fee</span>
</code></pre></div>

<p>For both strategies, the script reads an Excel file to adjust the grid fees (<a href="https://github.com/gridsingularity/gsy-e-sdk/blob/master/gsy_e_sdk/setups/resources/ToU.xlsx">ToU.xlsx</a> and <a href="https://github.com/gridsingularity/gsy-e-sdk/blob/master/gsy_e_sdk/setups/resources/Aziiz.xlsx">Aziiz.xlsx</a>). In ToU.xlsx the user can define the grid fees for each market she/he manages for every quarter hours of the day.</p>
<p><img alt="alt_text" src="../img/grid-operator-api-3.png" /></p>
<p>In Aziiz.xlsx grid fees can be set for every peak import/export thresholds for each market. The Aziiz strategy will compare the average of the last markets’ peak import/export to the threshold. If the average is lower than the threshold the relevant grid fee will be applied (for instance on the figure below if the average peak is equal to 22kWh, the next grid fee will be 3 cents/KWh. Each sheet’s name represents the market connected to.</p>
<p><img alt="alt_text" src="../img/grid-operator-api-4.png" /></p>
<p>On_market_slot event is used to gather market statistics and set the grid fees for the next market slot. In the first part, the Grid Operator API is requesting market statistics from the simulation.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># STORE MARKET INFORMATION</span>
<span class="c1">################################################</span>
<span class="k">for</span> <span class="n">area_uuid</span><span class="p">,</span> <span class="n">area_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_grid_tree_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">market_names</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">last_market_dso_stats</span><span class="p">(</span><span class="n">area_uuid</span><span class="p">)</span>

<span class="bp">self</span><span class="o">.</span><span class="n">dso_stats_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_batch_commands</span><span class="p">()</span>
</code></pre></div>

<p>Later in the script, the API is storing some of the relevant market data to local variables, easier to manipulate.</p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">area_uuid</span><span class="p">,</span> <span class="n">area_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_grid_tree_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">market_names</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last_market_fee</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;last_market_fee&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_market_fee</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;current_market_fee&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">market_event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dso_stats_response</span><span class="p">[</span><span class="s2">&quot;responses&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Store data from market info into variables - these variables are updated in a way that always just store the current/most updated values</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_trade_rate</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;market_stats&quot;</span><span class="p">][</span><span class="s2">&quot;min_trade_rate&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">avg_trade_rate</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;market_stats&quot;</span><span class="p">][</span><span class="s2">&quot;avg_trade_rate&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_trade_rate</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;market_stats&quot;</span><span class="p">][</span><span class="s2">&quot;max_trade_rate&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">median_trade_rate</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;market_stats&quot;</span><span class="p">][</span><span class="s2">&quot;median_trade_rate&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_traded_energy_kWh</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;market_stats&quot;</span><span class="p">][</span><span class="s2">&quot;total_traded_energy_kWh&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">self_sufficiency</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;market_stats&quot;</span><span class="p">][</span><span class="s2">&quot;self_sufficiency&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">self_consumption</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;market_stats&quot;</span><span class="p">][</span><span class="s2">&quot;self_consumption&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">import_kWh</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;market_stats&quot;</span><span class="p">][</span><span class="s1">&#39;area_throughput&#39;</span><span class="p">][</span><span class="s1">&#39;import&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">export_kWh</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;market_stats&quot;</span><span class="p">][</span><span class="s1">&#39;area_throughput&#39;</span><span class="p">][</span><span class="s1">&#39;export&#39;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">import_kWh</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_kWh</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">[</span><span class="n">market_event</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">balance_hist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># DataFrame that gets updated and grows at each market slot and contains the balance (import - export) for the areas</span>

        <span class="c1"># Print information in the terminal</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LAST MARKET STATISTICS&#39;</span><span class="p">)</span>

        <span class="n">last_market_table1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">market_names</span><span class="p">)):</span>
            <span class="n">keys_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_traded_energy_kWh</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_traded_energy_kWh</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">min_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_trade_rate</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">avg_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_trade_rate</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">med_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">median_trade_rate</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">max_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_trade_rate</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="c1"># Print None values as 0</span>
            <span class="n">values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values_list</span><span class="p">]</span>
            <span class="n">min_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">min_values_list</span><span class="p">]</span>
            <span class="n">avg_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">avg_values_list</span><span class="p">]</span>
            <span class="n">med_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">med_values_list</span><span class="p">]</span>
            <span class="n">max_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">max_values_list</span><span class="p">]</span>

            <span class="n">last_market_table1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">min_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">avg_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">med_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                 <span class="n">max_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

        <span class="n">last_market_headers1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Markets&quot;</span><span class="p">,</span> <span class="s2">&quot;Total energy traded [kWh]&quot;</span><span class="p">,</span> <span class="s2">&quot;Min trade rate [€cts/Kwh]&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Avg trade rate [€cts/Kwh]&quot;</span><span class="p">,</span> <span class="s2">&quot;Med trade rate [€cts/Kwh]&quot;</span><span class="p">,</span> <span class="s2">&quot;Max trade rate [€cts/Kwh]&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">last_market_table1</span><span class="p">,</span> <span class="n">last_market_headers1</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;fancy_grid&quot;</span><span class="p">))</span>

        <span class="n">last_market_table2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">market_names</span><span class="p">)):</span>
            <span class="n">keys_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_traded_energy_kWh</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">ss_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">self_sufficiency</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">sc_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">self_consumption</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">energy_imp_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">import_kWh</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">energy_exp_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_kWh</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">last_fee_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_market_fee</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="c1"># Print None values as 0</span>
            <span class="n">ss_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ss_values_list</span><span class="p">]</span>
            <span class="n">sc_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sc_values_list</span><span class="p">]</span>
            <span class="n">energy_imp_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">energy_imp_values_list</span><span class="p">]</span>
            <span class="n">energy_exp_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">energy_exp_values_list</span><span class="p">]</span>
            <span class="n">last_fee_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">last_fee_values_list</span><span class="p">]</span>

            <span class="n">last_market_table2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">keys_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ss_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sc_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">energy_imp_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                       <span class="n">energy_exp_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">last_fee_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

        <span class="n">last_market_headers2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Markets&quot;</span><span class="p">,</span> <span class="s2">&quot;Self sufficiency [%]&quot;</span><span class="p">,</span> <span class="s2">&quot;Self consumption [%]&quot;</span><span class="p">,</span> <span class="s2">&quot;Energy import [kWh]&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Energy export [kWh]&quot;</span><span class="p">,</span> <span class="s2">&quot;Last fee [€cts/Kwh]&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">last_market_table2</span><span class="p">,</span> <span class="n">last_market_headers2</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;fancy_grid&quot;</span><span class="p">))</span>

        <span class="c1">################################################</span>
        <span class="c1"># SET NEW GRID FEE</span>
        <span class="c1">################################################</span>
        <span class="k">for</span> <span class="n">area_uuid</span><span class="p">,</span> <span class="n">area_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_grid_tree_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">market_names</span><span class="p">:</span>
                <span class="c1">###################################################################</span>
                <span class="c1"># TIME OF USE STRATEGY</span>
                <span class="c1">###################################################################</span>
                <span class="k">if</span> <span class="n">TimeOfUse</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">next_market_fee</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduled_fee</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">market_time</span><span class="p">,</span> <span class="n">planned_fee</span><span class="p">,</span>
                                                                                      <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">])</span>

                <span class="c1">###################################################################</span>
                <span class="c1"># AZIIZ STRATEGY</span>
                <span class="c1">###################################################################</span>
                <span class="k">if</span> <span class="n">Aziiz</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">moving_average_peak</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">max_ext_energy_kWh</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance_hist</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
                                                      <span class="o">-</span><span class="n">look_back</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>  <span class="c1"># Calculate the absolute moving average of the net balance by looking back at 4 markets</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">max_ext_energy_kWh</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">import_kWh</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]],</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_kWh</span><span class="p">[</span>
                            <span class="n">area_dict</span><span class="p">[</span>
                                <span class="s2">&quot;area_name&quot;</span><span class="p">]])</span>  <span class="c1"># Calculate the max between the import and export of the defined market</span>

                    <span class="n">individual_market_prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">market_prices</span><span class="p">,</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">])</span>  <span class="c1"># Select the market in the file</span>

                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">individual_market_prices</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_ext_energy_kWh</span> <span class="o">&lt;=</span> <span class="n">individual_market_prices</span><span class="p">[</span><span class="s2">&quot;Threshold&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>  <span class="c1"># if the peak is lower than this value, the following grid fee will be applied. If the max is higher, it will go to the lower elif condition</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">next_market_fee</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">individual_market_prices</span><span class="p">[</span><span class="s2">&quot;Grid fee&quot;</span><span class="p">][</span>
                                <span class="n">k</span><span class="p">]</span>  <span class="c1"># new grid fee</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">next_market_fee</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span>
                                <span class="s2">&quot;area_name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">2000</span>  <span class="c1"># TODO set the last value if all the previous ones are not fulfilled</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">grid_fees</span><span class="p">(</span><span class="n">area_uuid</span><span class="o">=</span><span class="n">area_uuid</span><span class="p">,</span><span class="n">fee_cents_kwh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_market_fee</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]])</span>

        <span class="n">next_fee_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_batch_commands</span><span class="p">()</span>  <span class="c1"># send batch command</span>

        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CURRENT AND NEXT MARKET FEES&#39;</span><span class="p">)</span>

        <span class="n">current_market_table</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">market_names</span><span class="p">)):</span>
            <span class="n">keys_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_market_fee</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">current_fee_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_market_fee</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">next_fee_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">next_market_fee</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="n">current_fee_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">current_fee_values_list</span><span class="p">]</span>
            <span class="n">next_fee_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">next_fee_values_list</span><span class="p">]</span>

            <span class="n">current_market_table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">keys_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">current_fee_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">next_fee_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

        <span class="n">current_market_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Markets&quot;</span><span class="p">,</span> <span class="s2">&quot;Current fee [€cts/kWh]&quot;</span><span class="p">,</span> <span class="s2">&quot;Next fee [€cts/kWh]&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">current_market_table</span><span class="p">,</span> <span class="n">current_market_headers</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;fancy_grid&quot;</span><span class="p">))</span>

    <span class="c1">################################################</span>
    <span class="c1"># TRIGGERS EACH COMMAND RESPONSE AND EVENT</span>
    <span class="c1">################################################</span>
    <span class="k">def</span> <span class="nf">on_event_or_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="c1"># print(&quot;message&quot;,message)</span>
        <span class="k">pass</span>

    <span class="c1">################################################</span>
    <span class="c1"># SIMULATION TERMINATION CONDITION</span>
    <span class="c1">################################################</span>
    <span class="k">def</span> <span class="nf">on_finish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finish_info</span><span class="p">):</span>
        <span class="c1"># TODO export relevant information stored during the simulation (if needed)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span> <span class="o">=</span> <span class="kc">True</span>


<span class="c1">################################################</span>
<span class="c1"># REGISTER FOR MARKETS</span>
<span class="c1">################################################</span>
<span class="k">def</span> <span class="nf">get_assets_name</span><span class="p">(</span><span class="n">indict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is used to parse the grid tree and returned all registered assets</span>
<span class="sd">    wrapper for _get_assets_name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">indict</span> <span class="o">==</span> <span class="p">{}:</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="n">outdict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Area&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;Load&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;PV&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;Storage&quot;</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="n">_get_assets_name</span><span class="p">(</span><span class="n">indict</span><span class="p">,</span> <span class="n">outdict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outdict</span>


<span class="k">def</span> <span class="nf">_get_assets_name</span><span class="p">(</span><span class="n">indict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">outdict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse the collaboration / Canary Network registry</span>
<span class="sd">    Returns a list of the Market, Load, PV and Storage nodes the user is registered to</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">indict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span>
            <span class="n">area_type</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;registered&quot;</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">outdict</span><span class="p">[</span><span class="n">area_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;children&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">children</span> <span class="ow">in</span> <span class="n">indict</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="n">_get_assets_name</span><span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="n">outdict</span><span class="p">)</span>


<span class="c1"># Code to create the market aggregator and connect to the relevant simulation. Keep it as is</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_RUN_ON_REDIS&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
    <span class="n">MarketClient</span> <span class="o">=</span> <span class="n">RedisMarketClient</span>
    <span class="n">market_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;autoregister&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
    <span class="n">aggr</span> <span class="o">=</span> <span class="n">Oracle</span><span class="p">(</span><span class="n">aggregator_name</span><span class="o">=</span><span class="n">oracle_name</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="n">MarketClient</span> <span class="o">=</span> <span class="n">RestMarketClient</span>
    <span class="n">simulation_id</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_SIMULATION_ID&quot;</span><span class="p">]</span>
    <span class="n">domain_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_DOMAIN_NAME&quot;</span><span class="p">]</span>
    <span class="n">websockets_domain_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_WEBSOCKET_DOMAIN_NAME&quot;</span><span class="p">]</span>
    <span class="n">market_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;simulation_id&quot;</span><span class="p">:</span> <span class="n">simulation_id</span><span class="p">,</span>
                   <span class="s2">&quot;domain_name&quot;</span><span class="p">:</span> <span class="n">domain_name</span><span class="p">,</span> <span class="s2">&quot;websockets_domain_name&quot;</span><span class="p">:</span> <span class="n">websockets_domain_name</span><span class="p">}</span>

    <span class="n">aggr</span> <span class="o">=</span> <span class="n">Oracle</span><span class="p">(</span><span class="n">aggregator_name</span><span class="o">=</span><span class="n">oracle_name</span><span class="p">,</span> <span class="o">**</span><span class="n">market_args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">automatic</span><span class="p">:</span>
        <span class="n">registry</span> <span class="o">=</span> <span class="n">aggr</span><span class="o">.</span><span class="n">get_configuration_registry</span><span class="p">()</span>
        <span class="n">market_names</span> <span class="o">=</span> <span class="n">get_assets_name</span><span class="p">(</span><span class="n">registry</span><span class="p">)[</span><span class="s2">&quot;Area&quot;</span><span class="p">]</span>

<span class="n">market_prices</span><span class="p">,</span> <span class="n">planned_fee</span> <span class="o">=</span> <span class="n">fee_strategy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Connecting to markets ...&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">market_names</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_RUN_ON_REDIS&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
        <span class="n">market_registered</span> <span class="o">=</span> <span class="n">RedisMarketClient</span><span class="p">(</span><span class="n">area_id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">market_uuid</span> <span class="o">=</span> <span class="n">get_area_uuid_from_area_name_and_collaboration_id</span><span class="p">(</span><span class="n">market_args</span><span class="p">[</span><span class="s2">&quot;simulation_id&quot;</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">market_args</span><span class="p">[</span><span class="s2">&quot;domain_name&quot;</span><span class="p">])</span>
        <span class="n">market_args</span><span class="p">[</span><span class="s2">&quot;area_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">market_uuid</span>
        <span class="n">market_registered</span> <span class="o">=</span> <span class="n">RestMarketClient</span><span class="p">(</span><span class="o">**</span><span class="n">market_args</span><span class="p">)</span>
    <span class="n">selected</span> <span class="o">=</span> <span class="n">market_registered</span><span class="o">.</span><span class="n">select_aggregator</span><span class="p">(</span><span class="n">aggr</span><span class="o">.</span><span class="n">aggregator_uuid</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&gt; Connected to &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">aggr</span><span class="o">.</span><span class="n">device_uuid_list</span><span class="p">)</span>

<span class="c1"># loop to allow persistence</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">aggr</span><span class="o">.</span><span class="n">is_finished</span><span class="p">:</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

<p>In the following lines, to improve the API monitoring, the script is printing relevant data in the terminal:</p>
<p><img alt="alt_text" src="../img/grid-operator-api-5.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Print information in the terminal</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LAST MARKET STATISTICS&#39;</span><span class="p">)</span>

<span class="n">last_market_table1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">market_names</span><span class="p">)):</span>
    <span class="n">keys_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_traded_energy_kWh</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_traded_energy_kWh</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">min_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_trade_rate</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">avg_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_trade_rate</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">med_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">median_trade_rate</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">max_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_trade_rate</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="c1"># Print None values as 0</span>
    <span class="n">values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values_list</span><span class="p">]</span>
    <span class="n">min_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">min_values_list</span><span class="p">]</span>
    <span class="n">avg_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">avg_values_list</span><span class="p">]</span>
    <span class="n">med_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">med_values_list</span><span class="p">]</span>
    <span class="n">max_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">max_values_list</span><span class="p">]</span>

    <span class="n">last_market_table1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">min_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">avg_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">med_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
         <span class="n">max_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

<span class="n">last_market_headers1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Markets&quot;</span><span class="p">,</span> <span class="s2">&quot;Total energy traded [kWh]&quot;</span><span class="p">,</span> <span class="s2">&quot;Min trade rate [€cts/Kwh]&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Avg trade rate [€cts/Kwh]&quot;</span><span class="p">,</span> <span class="s2">&quot;Med trade rate [€cts/Kwh]&quot;</span><span class="p">,</span> <span class="s2">&quot;Max trade rate [€cts/Kwh]&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">last_market_table1</span><span class="p">,</span> <span class="n">last_market_headers1</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;fancy_grid&quot;</span><span class="p">))</span>

<span class="n">last_market_table2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">market_names</span><span class="p">)):</span>
    <span class="n">keys_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_traded_energy_kWh</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">ss_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">self_sufficiency</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">sc_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">self_consumption</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">energy_imp_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">import_kWh</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">energy_exp_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_kWh</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">last_fee_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_market_fee</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="c1"># Print None values as 0</span>
    <span class="n">ss_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ss_values_list</span><span class="p">]</span>
    <span class="n">sc_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sc_values_list</span><span class="p">]</span>
    <span class="n">energy_imp_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">energy_imp_values_list</span><span class="p">]</span>
    <span class="n">energy_exp_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">energy_exp_values_list</span><span class="p">]</span>
    <span class="n">last_fee_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">last_fee_values_list</span><span class="p">]</span>

    <span class="n">last_market_table2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">keys_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ss_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sc_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">energy_imp_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                               <span class="n">energy_exp_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">last_fee_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

<span class="n">last_market_headers2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Markets&quot;</span><span class="p">,</span> <span class="s2">&quot;Self sufficiency [%]&quot;</span><span class="p">,</span> <span class="s2">&quot;Self consumption [%]&quot;</span><span class="p">,</span> <span class="s2">&quot;Energy import [kWh]&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Energy export [kWh]&quot;</span><span class="p">,</span> <span class="s2">&quot;Last fee [€cts/Kwh]&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">last_market_table2</span><span class="p">,</span> <span class="n">last_market_headers2</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;fancy_grid&quot;</span><span class="p">))</span>
</code></pre></div>

<p>In the next section, the script applies the grid fee depending on the fee strategy chosen here. If the Time of Use was set, the markets’ grid fee is set based on the ToU excel file. If the Aziiz model was chosen the next fee is defined based on the Aziiz excel file. Additionally, if the peak import/export is higher than all threshold defined in the excel sheets this line sets the next fee as 2000cts/kWh. All the fees are added to the batch command and then executed.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># SET NEW GRID FEE</span>
<span class="c1">################################################</span>
<span class="k">for</span> <span class="n">area_uuid</span><span class="p">,</span> <span class="n">area_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_grid_tree_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="k">if</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">market_names</span><span class="p">:</span>
        <span class="c1">###################################################################</span>
        <span class="c1"># TIME OF USE STRATEGY</span>
        <span class="c1">###################################################################</span>
        <span class="k">if</span> <span class="n">TimeOfUse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">next_market_fee</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduled_fee</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">market_time</span><span class="p">,</span> <span class="n">planned_fee</span><span class="p">,</span>
                                                                              <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">])</span>

        <span class="c1">###################################################################</span>
        <span class="c1"># AZIIZ STRATEGY</span>
        <span class="c1">###################################################################</span>
        <span class="k">if</span> <span class="n">Aziiz</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">moving_average_peak</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_ext_energy_kWh</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance_hist</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
                                              <span class="o">-</span><span class="n">look_back</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>  <span class="c1"># Calculate the absolute moving average of the net balance by looking back at 4 markets</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_ext_energy_kWh</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">import_kWh</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]],</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_kWh</span><span class="p">[</span>
                    <span class="n">area_dict</span><span class="p">[</span>
                        <span class="s2">&quot;area_name&quot;</span><span class="p">]])</span>  <span class="c1"># Calculate the max between the import and export of the defined market</span>

            <span class="n">individual_market_prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">market_prices</span><span class="p">,</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">])</span>  <span class="c1"># Select the market in the file</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">individual_market_prices</span><span class="p">)):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_ext_energy_kWh</span> <span class="o">&lt;=</span> <span class="n">individual_market_prices</span><span class="p">[</span><span class="s2">&quot;Threshold&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>  <span class="c1"># if the peak is lower than this value, the following grid fee will be applied. If the max is higher, it will go to the lower elif condition</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">next_market_fee</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">individual_market_prices</span><span class="p">[</span><span class="s2">&quot;Grid fee&quot;</span><span class="p">][</span>
                        <span class="n">k</span><span class="p">]</span>  <span class="c1"># new grid fee</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">next_market_fee</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span>
                        <span class="s2">&quot;area_name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">2000</span>  <span class="c1"># TODO set the last value if all the previous ones are not fulfilled</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">grid_fees</span><span class="p">(</span><span class="n">area_uuid</span><span class="o">=</span><span class="n">area_uuid</span><span class="p">,</span><span class="n">fee_cents_kwh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_market_fee</span><span class="p">[</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]])</span>

<span class="n">next_fee_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_batch_commands</span><span class="p">()</span>  <span class="c1"># send batch command</span>
</code></pre></div>

<p>In the following lines, the script is printing the current fee and next fee for each market.</p>
<p><img alt="alt_text" src="../img/grid-operator-api-6.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CURRENT AND NEXT MARKET FEES&#39;</span><span class="p">)</span>

        <span class="n">current_market_table</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">market_names</span><span class="p">)):</span>
            <span class="n">keys_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_market_fee</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">current_fee_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_market_fee</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">next_fee_values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">next_market_fee</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="n">current_fee_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">current_fee_values_list</span><span class="p">]</span>
            <span class="n">next_fee_values_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">next_fee_values_list</span><span class="p">]</span>

            <span class="n">current_market_table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">keys_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">current_fee_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">next_fee_values_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

        <span class="n">current_market_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Markets&quot;</span><span class="p">,</span> <span class="s2">&quot;Current fee [€cts/kWh]&quot;</span><span class="p">,</span> <span class="s2">&quot;Next fee [€cts/kWh]&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">current_market_table</span><span class="p">,</span> <span class="n">current_market_headers</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;fancy_grid&quot;</span><span class="p">))</span>
</code></pre></div>

<p>Later, the on_event_or_response is overwritten. By default we do not perform any operation in this event but the user could add some if needed. For instance the user could record all the grid fee change responses received in that event.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># TRIGGERS EACH COMMAND RESPONSE AND EVENT</span>
<span class="c1">################################################</span>
<span class="k">def</span> <span class="nf">on_event_or_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="c1"># print(&quot;message&quot;,message)</span>
    <span class="k">pass</span>
</code></pre></div>

<p>Lastly, the SDK Script overwrites the on_finish event so that whenever the function is triggered the script stops. If the user wishes to save some information recorded within the Exchange SDK this would be the opportunity to export them to external files.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># SIMULATION TERMINATION CONDITION</span>
<span class="c1">################################################</span>
<span class="k">def</span> <span class="nf">on_finish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finish_info</span><span class="p">):</span>
    <span class="c1"># TODO export relevant information stored during the simulation (if needed)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>

<p>The rest of the script is used to connect to a running simulation/collaboration/Canary Test Network. These lines should work as is and no changes are required.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># REGISTER FOR MARKETS</span>
<span class="c1">################################################</span>
<span class="k">def</span> <span class="nf">get_assets_name</span><span class="p">(</span><span class="n">indict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is used to parse the grid tree and returned all registered assets</span>
<span class="sd">    wrapper for _get_assets_name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">indict</span> <span class="o">==</span> <span class="p">{}:</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="n">outdict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Area&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;Load&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;PV&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;Storage&quot;</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="n">_get_assets_name</span><span class="p">(</span><span class="n">indict</span><span class="p">,</span> <span class="n">outdict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outdict</span>


<span class="k">def</span> <span class="nf">_get_assets_name</span><span class="p">(</span><span class="n">indict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">outdict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse the collaboration / Canary Network registry</span>
<span class="sd">    Returns a list of the Market, Load, PV and Storage nodes the user is registered to</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">indict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span>
            <span class="n">area_type</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;registered&quot;</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">outdict</span><span class="p">[</span><span class="n">area_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;children&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">children</span> <span class="ow">in</span> <span class="n">indict</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="n">_get_assets_name</span><span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="n">outdict</span><span class="p">)</span>


<span class="c1"># Code to create the market aggregator and connect to the relevant simulation. Keep it as is</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_RUN_ON_REDIS&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
    <span class="n">MarketClient</span> <span class="o">=</span> <span class="n">RedisMarketClient</span>
    <span class="n">market_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;autoregister&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
    <span class="n">aggr</span> <span class="o">=</span> <span class="n">Oracle</span><span class="p">(</span><span class="n">aggregator_name</span><span class="o">=</span><span class="n">oracle_name</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="n">MarketClient</span> <span class="o">=</span> <span class="n">RestMarketClient</span>
    <span class="n">simulation_id</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_SIMULATION_ID&quot;</span><span class="p">]</span>
    <span class="n">domain_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_DOMAIN_NAME&quot;</span><span class="p">]</span>
    <span class="n">websockets_domain_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_WEBSOCKET_DOMAIN_NAME&quot;</span><span class="p">]</span>
    <span class="n">market_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;simulation_id&quot;</span><span class="p">:</span> <span class="n">simulation_id</span><span class="p">,</span>
                   <span class="s2">&quot;domain_name&quot;</span><span class="p">:</span> <span class="n">domain_name</span><span class="p">,</span> <span class="s2">&quot;websockets_domain_name&quot;</span><span class="p">:</span> <span class="n">websockets_domain_name</span><span class="p">}</span>

    <span class="n">aggr</span> <span class="o">=</span> <span class="n">Oracle</span><span class="p">(</span><span class="n">aggregator_name</span><span class="o">=</span><span class="n">oracle_name</span><span class="p">,</span> <span class="o">**</span><span class="n">market_args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">automatic</span><span class="p">:</span>
        <span class="n">registry</span> <span class="o">=</span> <span class="n">aggr</span><span class="o">.</span><span class="n">get_configuration_registry</span><span class="p">()</span>
        <span class="n">market_names</span> <span class="o">=</span> <span class="n">get_assets_name</span><span class="p">(</span><span class="n">registry</span><span class="p">)[</span><span class="s2">&quot;Area&quot;</span><span class="p">]</span>

<span class="n">market_prices</span><span class="p">,</span> <span class="n">planned_fee</span> <span class="o">=</span> <span class="n">fee_strategy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Connecting to markets ...&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">market_names</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_RUN_ON_REDIS&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
        <span class="n">market_registered</span> <span class="o">=</span> <span class="n">RedisMarketClient</span><span class="p">(</span><span class="n">area_id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">market_uuid</span> <span class="o">=</span> <span class="n">get_area_uuid_from_area_name_and_collaboration_id</span><span class="p">(</span><span class="n">market_args</span><span class="p">[</span><span class="s2">&quot;simulation_id&quot;</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">market_args</span><span class="p">[</span><span class="s2">&quot;domain_name&quot;</span><span class="p">])</span>
        <span class="n">market_args</span><span class="p">[</span><span class="s2">&quot;area_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">market_uuid</span>
        <span class="n">market_registered</span> <span class="o">=</span> <span class="n">RestMarketClient</span><span class="p">(</span><span class="o">**</span><span class="n">market_args</span><span class="p">)</span>
    <span class="n">selected</span> <span class="o">=</span> <span class="n">market_registered</span><span class="o">.</span><span class="n">select_aggregator</span><span class="p">(</span><span class="n">aggr</span><span class="o">.</span><span class="n">aggregator_uuid</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&gt; Connected to &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">aggr</span><span class="o">.</span><span class="n">device_uuid_list</span><span class="p">)</span>

<span class="c1"># loop to allow persistence</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">aggr</span><span class="o">.</span><span class="n">is_finished</span><span class="p">:</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

<p>For a video tutorial on the Grid Operator API, please follow this <a href="https://www.youtube.com/embed/LoYoyIy-C7M">link</a>.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/LoYoyIy-C7M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p><em>The next step is to adapt the <a href="https://github.com/gridsingularity/gsy-e-sdk/blob/master/gsy_e_sdk/setups/grid_operator_api_template.py">Grid Operator API template script</a>) developed by Grid Singularity to customize the grid fee strategies as you wish!</em></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../grid-operator-api-commands/" title="Grid Operator API Commands" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Grid Operator API Commands
              </span>
            </div>
          </a>
        
        
          <a href="../registration-grid-operator-api-user-interface/" title="Registration - Simulations run on the User-Interface" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Registration - Simulations run on the User-Interface
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-logo">
        <img src="../img/New_Logo2.0.png" height="50"/>
      </div>
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/gridsingularity" class="md-footer-social__link fa fa-lg fa-github"></a>
    
      <a href="https://twitter.com/gridsingularity" class="md-footer-social__link fa fa-lg fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/grid-singularity" class="md-footer-social__link fa fa-lg fa-linkedin"></a>
    
      <a href="https://join.slack.com/t/gsycommunity/shared_invite/zt-dpfxe2gk-hKFccsrr68g982odCJlrIg" class="md-footer-social__link fa fa-lg fa-slack"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.05d1c8d6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="https://research.web3.foundation/en/latest/mathjax-config.js"></script>
      
        <script src="../search/main.js"></script>
      
    
  </body>
</html>