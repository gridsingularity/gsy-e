



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the Grid Singularity Exchange">
      
      
        <link rel="canonical" href="https://gridsingularity.github.io/gsy-e/documentation/blockchain-matching-engine/">
      
      
        <meta name="author" content="Grid Singularity">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/Profile.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-4.0.2">
    
    
      
        <title>GSY DEX Matching Engine - Grid Singularity Wiki</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"PT Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#gsy-dex-matching-engine-implementation" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://gridsingularity.github.io/gsy-e/documentation/" title="Grid Singularity Wiki" class="md-header-nav__button md-logo">
          
            <img src="../img/Profile.png" width="32" height="32">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Grid Singularity Wiki
            </span>
            <span class="md-header-nav__topic">
              GSY DEX Matching Engine
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/gridsingularity/gsy-e/wiki" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Grid Singularity Exchange
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://gridsingularity.github.io/gsy-e/documentation/" title="Grid Singularity Wiki" class="md-nav__button md-logo">
      
        <img src="../img/Profile.png" width="48" height="48">
      
    </a>
    Grid Singularity Wiki
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/gridsingularity/gsy-e/wiki" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Grid Singularity Exchange
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      General Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        General Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../documentation/" title="Grid Singularity Mission" class="md-nav__link">
      Grid Singularity Mission
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../technical-approach/" title="Grid Singularity Technical Approach" class="md-nav__link">
      Grid Singularity Technical Approach
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../development-path/" title="Grid Singularity Development Path" class="md-nav__link">
      Grid Singularity Development Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../licensing/" title="Licensing and Open Source Ethos" class="md-nav__link">
      Licensing and Open Source Ethos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Set up a simulation of an active local energy market
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Set up a simulation of an active local energy market
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      Instructions for running simulations using the Grid Singularity interface: Singularity Map
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Instructions for running simulations using the Grid Singularity interface: Singularity Map
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../community/" title="Build a community" class="md-nav__link">
      Build a community
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1-2" type="checkbox" id="nav-2-1-2">
    
    <label class="md-nav__link" for="nav-2-1-2">
      Assets configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-2">
        Assets configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../configuration/" title="Assets Configuration Overview" class="md-nav__link">
      Assets Configuration Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../home/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../solar-panels/" title="Solar Panels (PVs)" class="md-nav__link">
      Solar Panels (PVs)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../consumption/" title="Consumption (Load) Profiles" class="md-nav__link">
      Consumption (Load) Profiles
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../battery/" title="Battery (Storage)" class="md-nav__link">
      Battery (Storage)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../power-plant/" title="Power Plant" class="md-nav__link">
      Power Plant
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1-2-7" type="checkbox" id="nav-2-1-2-7">
    
    <label class="md-nav__link" for="nav-2-1-2-7">
      Heat Pumps and District Heating
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-2-1-2-7">
        Heat Pumps and District Heating
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../heat-pumps-general/" title="Heat Pump & Virtual Heat Pump Overview" class="md-nav__link">
      Heat Pump & Virtual Heat Pump Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../heat-pump/" title="Heat Pump" class="md-nav__link">
      Heat Pump
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../virtual-heat-pump/" title="Virtual Heat Pump" class="md-nav__link">
      Virtual Heat Pump
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../community-settings/" title="Community Settings" class="md-nav__link">
      Community Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-market-settings/" title="Grid Market Settings" class="md-nav__link">
      Grid Market Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../events/" title="Events (Adding, Removing Assets, etc.)" class="md-nav__link">
      Events (Adding, Removing Assets, etc.)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Instructions for running simulations using the Grid Singularity backend code
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Instructions for running simulations using the Grid Singularity backend code
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2-1" type="checkbox" id="nav-2-2-1">
    
    <label class="md-nav__link" for="nav-2-2-1">
      Backend Installation Instructions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-1">
        Backend Installation Instructions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../linux-installation-instructions/" title="Linux Installation Instructions" class="md-nav__link">
      Linux Installation Instructions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ios-installation-instructions/" title="Mac Installation Instructions" class="md-nav__link">
      Mac Installation Instructions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vm-installation-instructions/" title="Windows Installation Instructions" class="md-nav__link">
      Windows Installation Instructions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version-update/" title="Version Updates" class="md-nav__link">
      Version Updates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2-2" type="checkbox" id="nav-2-2-2">
    
    <label class="md-nav__link" for="nav-2-2-2">
      Backend Simulation Configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-2">
        Backend Simulation Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../setup-configuration/" title="Setup Configuration" class="md-nav__link">
      Setup Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../setting-configuration-parameters/" title="Setting General Configuration Parameters" class="md-nav__link">
      Setting General Configuration Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../market-backend-configuration/" title="Market Backend Configuration" class="md-nav__link">
      Market Backend Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../assets-installation/" title="Assets Installation" class="md-nav__link">
      Assets Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../backend_events/" title="Configuring Events" class="md-nav__link">
      Configuring Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../launch_simulation/" title="Launching Simulation" class="md-nav__link">
      Launching Simulation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2-3" type="checkbox" id="nav-2-2-3">
    
    <label class="md-nav__link" for="nav-2-2-3">
      Backend Results
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-3">
        Backend Results
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../backend-results-overview/" title="Backend Results Overview" class="md-nav__link">
      Backend Results Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../backend-results-energy-bills/" title="Energy bills" class="md-nav__link">
      Energy bills
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requirements/" title="Data Requirements and File Upload Format" class="md-nav__link">
      Data Requirements and File Upload Format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Results and Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Results and Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../results-dashboard" title="Results dashboard" class="md-nav__link">
      Results dashboard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bills_savings/" title="Net Energy Traded, Energy Cost (Bill) and Energy Cost Savings" class="md-nav__link">
      Net Energy Traded, Energy Cost (Bill) and Energy Cost Savings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../self-sufficiency-self-consumption/" title="Self-Sufficiency and Self-Consumption" class="md-nav__link">
      Self-Sufficiency and Self-Consumption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../trade-profile/" title="Trade Profile and Energy Peak Percentage" class="md-nav__link">
      Trade Profile and Energy Peak Percentage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aggregate-market-summary/" title="Aggregate Market Summary" class="md-nav__link">
      Aggregate Market Summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../price/" title="Price Graph" class="md-nav__link">
      Price Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../trades/" title="Cumulative trades chart and bids and offers graph" class="md-nav__link">
      Cumulative trades chart and bids and offers graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../results-download/" title="Results Download" class="md-nav__link">
      Results Download
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../duplicating-simulations" title="Duplicating simulations" class="md-nav__link">
      Duplicating simulations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Market Mechanisms
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Market Mechanisms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../trading-agents-and-strategies/" title="Grid Singularity Exchange Trading Agents and Strategies" class="md-nav__link">
      Grid Singularity Exchange Trading Agents and Strategies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../market-types/" title="Grid Singularity Exchange Market Types" class="md-nav__link">
      Grid Singularity Exchange Market Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-fee-accounting/" title="Grid Fee Accounting" class="md-nav__link">
      Grid Fee Accounting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Collaborations and APIs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Collaborations and APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../collaboration/" title="Create a Grid Singularity Collaboration" class="md-nav__link">
      Create a Grid Singularity Collaboration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Connect to the Grid Singularity APIs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Connect to the Grid Singularity APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../APIs-introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2-2" type="checkbox" id="nav-5-2-2">
    
    <label class="md-nav__link" for="nav-5-2-2">
      Create custom trading agents using the Grid Singularity Asset API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-5-2-2">
        Create custom trading agents using the Grid Singularity Asset API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../configure-trading-strategies-walkthrough/" title="Grid Singularity Asset API Overview" class="md-nav__link">
      Grid Singularity Asset API Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../asset-api-events/" title="Asset API Events" class="md-nav__link">
      Asset API Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../asset-api-commands/" title="Asset API Commands" class="md-nav__link">
      Asset API Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../asset-api-template-script/" title="Asset API Template Script" class="md-nav__link">
      Asset API Template Script
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2-2-5" type="checkbox" id="nav-5-2-2-5">
    
    <label class="md-nav__link" for="nav-5-2-2-5">
      Launch the Asset API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-5-2-2-5">
        Launch the Asset API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-asset-api-user-interface/" title="Registration - Simulations run on the User-Interface" class="md-nav__link">
      Registration - Simulations run on the User-Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-asset-api-backend/" title="Registration - Simulations run on the Backend" class="md-nav__link">
      Registration - Simulations run on the Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2-3" type="checkbox" id="nav-5-2-3">
    
    <label class="md-nav__link" for="nav-5-2-3">
      Implement dynamic grid fees through the Grid Singularity Grid Operator API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-5-2-3">
        Implement dynamic grid fees through the Grid Singularity Grid Operator API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../implement-grid-fees-walkthrough/" title="Grid Singularity Grid Operator API Overview" class="md-nav__link">
      Grid Singularity Grid Operator API Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-operator-api-events/" title="Grid Operator API Events" class="md-nav__link">
      Grid Operator API Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-operator-api-commands/" title="Grid Operator API Commands" class="md-nav__link">
      Grid Operator API Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-operator-api-template-script/" title="Grid Operator API Template Script" class="md-nav__link">
      Grid Operator API Template Script
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2-3-5" type="checkbox" id="nav-5-2-3-5">
    
    <label class="md-nav__link" for="nav-5-2-3-5">
      Launch the Grid Operator API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-5-2-3-5">
        Launch the Grid Operator API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-grid-operator-api-user-interface/" title="Registration - Simulations run on the User-Interface" class="md-nav__link">
      Registration - Simulations run on the User-Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-grid-operator-api-backend/" title="Registration - Simulations run on the Backend" class="md-nav__link">
      Registration - Simulations run on the Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2-4" type="checkbox" id="nav-5-2-4">
    
    <label class="md-nav__link" for="nav-5-2-4">
      Customize the clearing algorithm through the Grid Singularity Matching API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-5-2-4">
        Customize the clearing algorithm through the Grid Singularity Matching API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../matching-api-walkthrough/" title="Grid Singularity Matching API Overview" class="md-nav__link">
      Grid Singularity Matching API Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../matching-api-events/" title="Matching API Events" class="md-nav__link">
      Matching API Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../matching-api-commands/" title="Matching API Commands" class="md-nav__link">
      Matching API Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../matching-api-template-script/" title="Matching API Template Script" class="md-nav__link">
      Matching API Template Script
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2-4-5" type="checkbox" id="nav-5-2-4-5">
    
    <label class="md-nav__link" for="nav-5-2-4-5">
      Launch the Matching API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-5-2-4-5">
        Launch the Matching API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-matching-api-user-interface/" title="Registration - Simulations run on the User-Interface" class="md-nav__link">
      Registration - Simulations run on the User-Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-matching-api-backend/" title="Registration - Simulations run on the Backend" class="md-nav__link">
      Registration - Simulations run on the Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../get-simulation-data/" title="Extract data (historical profile and grid topology) through the Grid Singularity Historical Data and Grid Data APIs" class="md-nav__link">
      Extract data (historical profile and grid topology) through the Grid Singularity Historical Data and Grid Data APIs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Grid Singularity Canary Test Network
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Grid Singularity Canary Test Network
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-ctn/" title="Connect to a Grid Singularity Canary Test Network" class="md-nav__link">
      Connect to a Grid Singularity Canary Test Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      Send live energy asset data streams to the Grid Singularity exchange
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        Send live energy asset data streams to the Grid Singularity exchange
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../connection-energy-assets/" title="Establish a connection with your energy assets" class="md-nav__link">
      Establish a connection with your energy assets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../send-data-exchange-sdk/" title="Send live data streams via the Exchange SDK" class="md-nav__link">
      Send live data streams via the Exchange SDK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../send-data-rest-api/" title="Send live data streams via the REST API" class="md-nav__link">
      Send live data streams via the REST API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Blockchain Integration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Blockchain Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../blockchain/" title="GSY DEX Overview" class="md-nav__link">
      GSY DEX Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../blockchain-system-components-overview/" title="GSY DEX System Components Overview" class="md-nav__link">
      GSY DEX System Components Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../blockchain-installation/" title="GSY DEX Node Installation, Operation and Development" class="md-nav__link">
      GSY DEX Node Installation, Operation and Development
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../blockchain-off-chain-storage/" title="GSY DEX Off-Chain Storage" class="md-nav__link">
      GSY DEX Off-Chain Storage
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        GSY DEX Matching Engine
      </label>
    
    <a href="./" title="GSY DEX Matching Engine" class="md-nav__link md-nav__link--active">
      GSY DEX Matching Engine
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gsy-dex-matching-engine-implementation" title="GSY DEX Matching Engine Implementation" class="md-nav__link">
    GSY DEX Matching Engine Implementation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gsy-dex-matching-api" title="GSY DEX Matching API" class="md-nav__link">
    GSY DEX Matching API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gsy-dex-matching-engine-gsy-off-chain-storage-communication" title="GSY DEX Matching Engine / GSY Off-Chain Storage Communication" class="md-nav__link">
    GSY DEX Matching Engine / GSY Off-Chain Storage Communication
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gsy-dex-matching-engine-gsy-node-communication-trade-settlement-pallet" title="GSY DEX Matching Engine / GSY Node Communication - Trade Settlement Pallet" class="md-nav__link">
    GSY DEX Matching Engine / GSY Node Communication - Trade Settlement Pallet
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#communication-overview" title="Communication Overview" class="md-nav__link">
    Communication Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events" title="Events" class="md-nav__link">
    Events
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#errors" title="Errors" class="md-nav__link">
    Errors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dispatchable-functions" title="Dispatchable functions" class="md-nav__link">
    Dispatchable functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-functions" title="Helper functions" class="md-nav__link">
    Helper functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../references/" title="References" class="md-nav__link">
      References
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../releases/" title="Releases Archive" class="md-nav__link">
      Releases Archive
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gsy-dex-matching-engine-implementation" title="GSY DEX Matching Engine Implementation" class="md-nav__link">
    GSY DEX Matching Engine Implementation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gsy-dex-matching-api" title="GSY DEX Matching API" class="md-nav__link">
    GSY DEX Matching API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gsy-dex-matching-engine-gsy-off-chain-storage-communication" title="GSY DEX Matching Engine / GSY Off-Chain Storage Communication" class="md-nav__link">
    GSY DEX Matching Engine / GSY Off-Chain Storage Communication
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gsy-dex-matching-engine-gsy-node-communication-trade-settlement-pallet" title="GSY DEX Matching Engine / GSY Node Communication - Trade Settlement Pallet" class="md-nav__link">
    GSY DEX Matching Engine / GSY Node Communication - Trade Settlement Pallet
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#communication-overview" title="Communication Overview" class="md-nav__link">
    Communication Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events" title="Events" class="md-nav__link">
    Events
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#errors" title="Errors" class="md-nav__link">
    Errors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dispatchable-functions" title="Dispatchable functions" class="md-nav__link">
    Dispatchable functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-functions" title="Helper functions" class="md-nav__link">
    Helper functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/gridsingularity/gsy-e/wiki/edit/master/docs/blockchain-matching-engine.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>GSY DEX Matching Engine</h1>
                
                <p>The GSY Matching Engine is a critical component of the Grid Singularity Decentralised Exchange (<a href="../blockchain/">GSY DEX</a>) purposed to efficiently and securely match the select market supply with demand, based on participant preferences and market conditions. Whilst it can be used for any commodity, the GSY Matching Engine has been tailored for the electricity market. It integrates directly with the <a href="../blockchain-off-chain-storage/">GSY Off-Chain Storage</a> for real-time bid and offer access via its Order Book Storage, and with the <a href="../blockchain-system-components-overview/#gsy-node">GSY Node</a> for trade settlement in conjunction with a trade execution (energy delivery) verification service provided by the <a href="../blockchain-system-components-overview/#gsy-dex-execution-engine">GSY Execution Engine</a>. The GSY Matching Engine deploys a <a href="../market-types/#two-sided-pay-as-bid-market">pay-as-bid</a> strategy, ensuring that buyers and sellers receive the best possible prices for their energy trades. Future versions will integrate pay-as-clear and automated market maker (AMM) as alternative trading mechanisms. Furthermore, the intent is to render the GSY Matching Engine available as an autonomous service application in the <a href="https://www.smartflow.org/#products" target="_blank">Energy Web SmartFlow Launchpad</a>, leveraging the Energy Web infrastructure and facilitating integration with a wider range of third-party applications, even beyond the energy market.</p>
<p>Multi-attribute auctions, which account for participant preferences and applicable market conditions, require more advanced clearing algorithms than single attribute auctions, such as those based on price alone. The optimal approach is to engage <a href="../blockchain-off-chain-storage/">off-chain workers</a> to operate matching algorithms and then require either the use of trusted execution environments (enclaves) or on-chain verification to determine whether the matching algorithm was correctly executed. To enable this solution, the matching process is decoupled from the settlement verification and moved to a dedicated component, the Matching Engine. The GSY DEX Matching Engine has been designed to operate as (one or multiple) individual autonomous service(s), responsible for identifying suitable matches for multiple open order books. In order to manage the available GSY Matching Engine services, the GSY Node needs to register each such service and associate it with a user account responsible for operating the respective service. Grid Singularity will facilitate the Matching Engine registration process for the <a href="../blockchain/">GSY DEX</a>.</p>
<p>The GSY DEX Matching Engine reads open bids and offers through the <a href="#gsy-dex-matching-api">GSY DEX Matching API</a> and submits matches for validation based on the <a href="../matching-api-walkthrough/">following process</a>. Since the exchange’s verification function (part of GSY Node) only checks the validity of each match rather than the result of a specific matching algorithm, there is no longer a need for an agreed matching algorithm, arbitration technique, or redundant off-chain worker computation. This alleviates the need for additional on-chain computational cost, avoiding a corresponding increase to the gas costs associated with matching. Moreover, the GSY Node verification function is able to ascertain whether the bid and offer limitations are satisfied by the matches generated by the GSY Matching Engine (for instance, if the clearing energy rate is lower than or equal to the bid rate and higher than or equal to the offer rate). Therefore, multiple competing GSY Matching Engines can calculate matches for different markets in parallel, each using their own matching algorithm, and afterwards the GSY Node can select and verify the matches that are eligible for clearing, and reject those that are violating their bid and offer requirements. Finally, as the verification function is executed on-chain any potential errors or fraud attempts, such as double counting of trades and matching results, are eliminated. The validation of the actual delivery of the traded energy cannot be performed at this time, due to the fact that the energy is traded ahead-of-time. Another GSY DEX service, the <a href="../blockchain-system-components-overview/#gsy-dex-execution-engine">GSY Execution Engine</a>, is tasked with reading the asset measurements of produced or consumed energy, thereby validating whether the energy delivery corresponds to the traded energy.</p>
<p>The main functions of the GSY DEX Matching Engine are the following:</p>
<ul>
<li>Order Retrieval: The GSY Matching Engine retrieves orders from the <a href="../blockchain-off-chain-storage/">GSY DEX Off-Chain Storage</a>. This storage system holds all active bids and offers, which the GSY Matching Engine reads in order to match suitable counterparts for energy trades.</li>
<li>Matching Process: Pursuant to the <a href="../market-types/#two-sided-pay-as-bid-market">pay-as-bid</a> strategy, the GSY Matching Engine pairs bids and offers according to price and quantity to maximise value for the exchange participants. Buy orders are organised in a descending order of price, prioritising buyers willing to pay more, while sell orders are arranged in an ascending order, prioritising sellers willing to sell energy at lower prices. This strategy ensures that both parties upon clearance pay or receive the desired price for their energy trade based on their submitted bids and offers.</li>
<li>Submission to <a href="../blockchain-system-components-overview/#gsy-node">GSY Node</a>: Once the GSY Matching Engine has identified the optimal matches, it submits these matches to the <a href="../blockchain-system-components-overview/#gsy-node">GSY Node</a> for further processing and execution. This seamless integration with the <a href="../blockchain-system-components-overview/#gsy-node">GSY Node</a> and the <a href="../blockchain-off-chain-storage/">GSY DEX Off-Chain Storage</a> allows for efficient energy trading by offloading the GSY Node from the most computationally intensive operations of the matching process. At the same time, the immutability and integrity of the data are not jeopardised, since the GSY Node also participates in the verification process. Lastly, the <a href="../blockchain-system-components-overview/#gsy-dex-execution-engine">GSY Execution Engine</a> verifies that the energy trades correspond to the energy delivery.</li>
</ul>
<p>To summarise, the GSY Matching Engine is <a href="../development-path/">designed</a> as an autonomous <a href="../blockchain-system-components-overview/">GSY DEX</a> service, applied in conjunction with other services of the decentralised Grid Singularity Exchange, to achieve the following performance optimisation:</p>
<ul>
<li>Enhanced Performance: The matching process is a computationally and memory-intensive operation that requires significant computational resources. By creating a dedicated matching engine, we ensure that the <a href="../blockchain-system-components-overview/#gsy-node">GSY Node</a> can continue to handle other platform functions without being overloaded by the resource-intensive matching process.</li>
<li>Gas/Transaction Costs: By creating a dedicated matching engine that interacts with the off-chain storage for the most computationally intensive operations rather than using the GSY Node to execute the entire matching process on-chain, transaction costs are significantly reduced.</li>
<li>Scalability: The GSY Matching Engine independent architecture ensures the platform remains responsive and efficient as the volume of market participants and transactions expands without affecting the performance of the <a href="../blockchain-system-components-overview/#gsy-node">GSY Node</a>.</li>
<li>Flexibility: As a standalone service, the GSY Matching Engine can be easily updated or modified without impacting other platform components. This allows for the continuous improvement of the order matching process and overall energy trading experience for platform users. Moreover, the GSY Matching Engine enables operation of multiple different matching algorithms in parallel, thus providing the flexibility to use different matching algorithms per market or energy community. This facilitates conformance to local regulation, by not restricting Community Managers to a single matching process, but allowing them to tailor the matching process to their needs.</li>
</ul>
<h2 id="gsy-dex-matching-engine-implementation">GSY DEX Matching Engine Implementation<a class="headerlink" href="#gsy-dex-matching-engine-implementation" title="Permanent link">&para;</a></h2>
<p>The GSY DEX Matching Engine is implemented in <a href="https://www.rust-lang.org/" target="_blank">Rust</a>, in order to take advantage of the ease of interconnection with other components of the GSY DEX, especially with the GSY Node, and the Rust performance benefits compared to other programming languages. The Matching Engine’s operation revolves around a loop that continuously submits requests to the <a href="../blockchain-off-chain-storage/">GSY DEX Off-Chain Storage</a> as to whether new open offers or bids have been created. If the Off-Chain Storage reports that new offers and bids have been created, the Matching Engine calls the applicable matching algorithm to calculate the matches and then transmits the calculated matches to the GSY Node. The main Rust modules that comprise the Matching Engine are the Algorithms Module and the Connectors Module.</p>
<figure>
<p><img alt="alt_text" src="../img/blockchain-matching-engine-dataflow.png" text-align:center_="text-align:center&quot;" />
  <figcaption><b>Figure 1</b>: The GSY DEX Matching Engine Dataflow
</figcaption></p>
</figure>
<p>The GSY DEX Matching Engine <a href="https://github.com/gridsingularity/gsy-decentralized-exchange/tree/main/gsy-matching-engine/src/algorithms" target="_blank">Algorithms Module</a> stores the available matching algorithms. Currently the <a href="../market-types/#two-sided-pay-as-bid-market">two-sided pay-as-bid</a> algorithm is supported, with additional matching algorithms to be added in the future, either by Grid Singularity or a third party via the GSY DEX Matching API. Furthermore, the design of the Algorithms Module allows multiple algorithms to be deployed in parallel. For instance, different matching algorithms can be applied in different energy communities, or in different buildings within an energy community to optimise their asset configuration</p>
<p>The currently applied two-sided pay-as-bid algorithm does not require the offer and bid to fully match each other’s respective energy consumption and production. The algorithm can also conclude a bid-offer match that partially trades the energy required by the bid and/or provided by the offer, with the expectation that the rest of the required or offered energy will be traded at a later time. Subsequently, the residual energy of the bid and/or the offer can be processed by the Matching Engine either in the same list of matches, or in one of the following lists of matches by creating  a new offer and bid that will represent the residual energy.</p>
<p>The <a href="https://github.com/gridsingularity/gsy-decentralized-exchange/tree/main/gsy-matching-engine/src/connectors" target="_blank">Connectors Module</a> handles the interconnection with the GSY Off-Chain Storage and the GSY Node. The Rust library <a href="https://github.com/paritytech/subxt" target="_blank">Subxt</a> (developed by Parity), which is the most common and robust way of interacting with Substrate nodes, is used for the interconnection with the GSY Node. For the interconnection with the GSY Off-Chain Storage, <a href="https://crates.io/crates/reqwest" target="_blank">reqwest</a> and <a href="https://tokio.rs/" target="_blank">tokio</a> are used as an asynchronous HTTP client.</p>
<p>The GSY DEX Matching Engine has been customised for the energy market by setting the traded commodity to energy and using kWh for the traded volume and cents/kWh for the trade rate and adapting other relevant parameters.</p>
<h2 id="gsy-dex-matching-api">GSY DEX Matching API<a class="headerlink" href="#gsy-dex-matching-api" title="Permanent link">&para;</a></h2>
<p>The GSY DEX Matching API defines the protocol of communication between the Matching Engine and other components of the GSY DEX, following the espoused approach of the Grid Singularity Engine. The API has two components, one for the inputs required by the Matching Engine to calculate the possible bid-offer matches, and one for transmitting the calculated matches to the GSY Node, in order for energy trades to be generated and trade settlement to be performed.</p>
<p>The inputs required by the GSY DEX Matching Engine are the open bids and the offers that are available for a <a href="../markets/#market-slots">market slot</a> (energy delivery time period). These are retrieved not via the GSY Node, but by leveraging the API of the GSY DEX Off-Chain Storage, thereby minimising the gas cost required for the operation of the Matching Engine, and consequently decreasing the computational effort required from the GSY Node.</p>
<p>The bid-offer matches calculated by the Matching Engine are transmitted to the GSY Node via the <a href="#gsy-dex-matching-engine--gsy-node-communication---trade-settlement-pallet">Trade Settlement Pallet</a>. This GSY Node pallet provides dispatchable functions that can be remotely called, in order to accept the list of bid-offer matches calculated by the Matching Engine, validate them, and subsequently create the energy trades.</p>
<h3 id="gsy-dex-matching-engine-gsy-off-chain-storage-communication">GSY DEX Matching Engine / GSY Off-Chain Storage Communication<a class="headerlink" href="#gsy-dex-matching-engine-gsy-off-chain-storage-communication" title="Permanent link">&para;</a></h3>
<p>To calculate the bid and offer matches, the GSY Matching Engine reads the open offers and bids from the <a href="../blockchain-off-chain-storage/">Off-Chain Storage</a> by calling the <code>GET /order</code> <a href="../blockchain-off-chain-storage/#http-rest-api-schema">REST API endpoint of the Off-Chain Storage</a>. The endpoint will return lists of JSON objects containing all open <code>Bid</code> and <code>Offer</code> structures, which will then be used to generate the <code>BidOfferMatch</code> objects during the order matching process. The JSON format of the output is the following:</p>
<pre class="codehilite"><code class="language-json">[
  {
    &quot;type&quot;: &quot;Bid&quot;,
    &quot;buyer&quot;: &lt;account id of the energy buyer who submitted the bid&gt;,
    &quot;nonce&quot;: &lt;unique identifier of the bid, autoincremented int&gt;,
    &quot;bid_component&quot;: {
      &quot;area_uuid&quot;: &lt;unique identifier of the asset or market area that posted the bid&gt;,
      &quot;market_uuid&quot;: &lt;unique identifier of the market that the bid belongs to&gt;,
      &quot;time_slot&quot;: &lt;timestamp of the expected energy consumption&gt;,
      &quot;creation_time&quot;: &lt;time that the bid was posted to the exchange&gt;,
      &quot;energy&quot;: &lt;energy in kWh * scaling factor, that the buyer is willing to buy&gt;,
      &quot;energy_rate&quot;: &lt;energy_rate, in cents/kWh that the buyer is willing to pay&gt;
    }
  },
  {
    &quot;type&quot;: &quot;Offer&quot;,
    &quot;seller&quot;: &lt;account id of the energy seller who submitted the offer&gt;,
    &quot;Nonce&quot;: &lt;unique identifier of the offer, autoincremented int&gt;,
    &quot;offer_component&quot;: {
      &quot;area_uuid&quot;: &lt;unique identifier of the asset or market area that posted the offer&gt;,
      &quot;Market_uuid&quot;: &lt;unique identifier of the market that the offer belongs to&gt;,
      &quot;time_slot&quot;: &lt;timestamp of the expected energy production&gt;,
      &quot;creation_time&quot;: &lt;time that the offer was posted to the exchange&gt;,
      &quot;energy&quot;: &lt;energy in kWh * scaling factor, that the seller is willing to sell&gt;,
      &quot;energy_rate&quot;: &lt;energy_rate, in cents/kWh that the seller is willing to earn&gt;
    }
  }
]</code></pre>


<figcaption><b>Figure 2</b>: Template of GSY DEX Off-Chain Storage Bid and Offer structures that are read by the GSY DEX Matching Engine</figcaption>

<h3 id="gsy-dex-matching-engine-gsy-node-communication-trade-settlement-pallet">GSY DEX Matching Engine / GSY Node Communication - Trade Settlement Pallet<a class="headerlink" href="#gsy-dex-matching-engine-gsy-node-communication-trade-settlement-pallet" title="Permanent link">&para;</a></h3>
<p>The Trade Settlement pallet provides a decentralised trade verification functionality that allows its users to:</p>
<ul>
<li>Verify whether bid-offer matches can result in an energy trade and whether any of the matches violate a mandatory requirement of the bid or offer (e.g. the clearing rate of a match may violate the bid or offer energy rate);</li>
<li>Generate the energy trade and perform the financial clearing between the buyer and the seller of energy; and</li>
<li>Transmit the trade to the Off-Chain Storage for any further processing (e.g. by the Analytics Engine to generate performance indicators).</li>
</ul>
<p>Moreover, the pallet supports partial offer / bid matching, meaning that the energy from an offer or bid can be used partially and that it is not mandatory that it be used in full. The pallet is able to update the respective bid / offer with the residual energy (energy that remains after the trade was performed) and use the residual energy for matches that are processed at a later time.</p>
<h4 id="communication-overview">Communication Overview<a class="headerlink" href="#communication-overview" title="Permanent link">&para;</a></h4>
<p>In order to persist a batch of matches, the GSY Matching Engine calls the <code>settle_trades</code> pallet method, including a vector of <code>BidOfferMatch</code> structures, each representing a single Offer-Bid match. The pallet method then validates these matches and executes the trade. The BidOfferMatch structure is part of the <a href="../blockchain-installation/#the-trades-module">Trades module</a>, and includes the following information:</p>
<ul>
<li><code>market_id</code>: Unique identifier of the market to which the bid and offer of the match belong</li>
<li><code>time_slot</code>: Time slot of the market to which the Bid and Offer of the match belong. It signifies the time that the delivery of the traded energy should take place</li>
<li><code>bid</code>: The <a href="../blockchain-off-chain-storage/#order-book-storage-database-schema">Bid struct</a> that represents the energy demand of the match</li>
<li><code>offer</code>: The <a href="../blockchain-off-chain-storage/#order-book-storage-database-schema">Offer struct</a> that represents the energy supply of the match.</li>
<li><code>residual_bid</code>: Optional Bid struct that represents the residual energy that was not traded from the original Bid</li>
<li><code>residual_offer</code>: Optional Offer struct that represents the residual energy that was not traded from the original Offer</li>
<li><code>selected_energy</code>: The traded energy of the match, in kWh.</li>
<li><code>energy_rate</code>: The energy rate of the resulting trade, in cents/kWh.</li>
</ul>
<h4 id="events">Events<a class="headerlink" href="#events" title="Permanent link">&para;</a></h4>
<ul>
<li><code>TradeCleared</code>: Emitted when a trade is created and cleared</li>
<li>Since the <a href="../blockchain-installation/#order-book-registry-pallet">Order Book Registry</a> and the Order Book Worker pallets are used by this pallet, all events emitted by them can also be emitted by the Trade Settlement pallet.</li>
</ul>
<h4 id="errors">Errors<a class="headerlink" href="#errors" title="Permanent link">&para;</a></h4>
<ul>
<li><code>NotSameLength</code>: Ensure that bid, offer and trade vectors have the same length.</li>
<li><code>NoValidMatchToSettle</code>: Ensure that there are valid matches to settle.</li>
<li><code>OrdersNotExecutable</code>: Ensure that the order’s execution returns an OK(()) value.</li>
<li><code>OrderNotRegistered</code>: Ensure the order has been registered in the Order Book Registry.</li>
<li><code>OfferEnergyRateGreaterThanBidEnergyRate</code>: Ensure that the offered energy rate is lower than the bid energy rate.</li>
<li><code>OfferEnergyLessThanSelectedEnergy</code>: Ensure that the offered energy rate is higher than the  selected energy.</li>
<li><code>BidEnergyLessThanSelectedEnergy</code>: Ensure that the bid energy rate is higher than the  selected energy.</li>
<li><code>UnableToSubtractEnergy</code>: Ensure that the energy subtraction in the validation is correct.</li>
</ul>
<h4 id="dispatchable-functions">Dispatchable functions<a class="headerlink" href="#dispatchable-functions" title="Permanent link">&para;</a></h4>
<ul>
<li><code>settle_trades</code>: Perform trade clearing / settlement for a list / vector of proposed matches. Proposed matches are of the type <code>Vec&lt;BidOfferMatch&lt;T::AccountId&gt;&gt;</code> thus allowing multiple BidOfferMatch objects to be settled at once from the dispatchable function. Uses functions of the Validator trait for the validation of each match, the orderbook_registry pallet for accessing the orders that consist of the match and creating the Trade object, and the orderbook_worker pallet for transmitting the result of the trade settlement to the Off-Chain Storage for any further processing.</li>
</ul>
<h4 id="helper-functions">Helper functions<a class="headerlink" href="#helper-functions" title="Permanent link">&para;</a></h4>
<ul>
<li><code>validate</code>: Validates a single bid-offer match.</li>
<li><code>validate_bid_energy_component</code>: Validate the energy amount of the bid against a select energy amount.</li>
<li><code>validate_offer_energy_component</code>: Validate the energy amount of the offer against a select energy amount.</li>
<li><code>validate_energy_rate</code>: Validate the energy rate of the bid against the energy rate of the offer.</li>
<li><code>validate_residual_bid</code>: Validate the residual bid in the match.</li>
<li><code>validate_residual_offer</code>: Validate the residual offer in the match.</li>
<li><code>validate_time_slots</code>: Validate the time slot of the bid and the offer in the match.</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../blockchain-off-chain-storage/" title="GSY DEX Off-Chain Storage" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                GSY DEX Off-Chain Storage
              </span>
            </div>
          </a>
        
        
          <a href="../references/" title="References" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                References
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-logo">
        <img src="../img/New_Logo2.0.png" height="50"/>
      </div>
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/gridsingularity" class="md-footer-social__link fa fa-lg fa-github"></a>
    
      <a href="https://twitter.com/gridsingularity" class="md-footer-social__link fa fa-lg fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/grid-singularity" class="md-footer-social__link fa fa-lg fa-linkedin"></a>
    
      <a href="https://join.slack.com/t/gsycommunity/shared_invite/zt-dpfxe2gk-hKFccsrr68g982odCJlrIg" class="md-footer-social__link fa fa-lg fa-slack"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.05d1c8d6.js"></script>
      
      <script>app.initialize({version:"1.3.0",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="https://research.web3.foundation/en/latest/mathjax-config.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../search/main.js"></script>
      
    
  </body>
</html>